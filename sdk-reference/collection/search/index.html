<!doctype html><html><head><meta http-equiv=Content-Type content="text/html; charset=utf-8"><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta name=msapplication-TileColor content=#FFFFFF><meta name=msapplication-TileImage content=http://docs.kuzzle.io/assets/images/favicon/mstile-144x144.png><meta name=msapplication-square70x70logo content=http://docs.kuzzle.io/assets/images/favicon/mstile-70x70.png><meta name=msapplication-square150x150logo content=http://docs.kuzzle.io/assets/images/favicon/mstile-150x150.png><meta name=msapplication-wide310x150logo content=http://docs.kuzzle.io/assets/images/favicon/mstile-310x150.png><meta name=msapplication-square310x310logo content=http://docs.kuzzle.io/assets/images/favicon/mstile-310x310.png><meta name=google-site-verification content=luspUdq52gkUU0FFChQ2xmeXSs5HDafpARQ7fVXVBp4><meta itemprop=name content=search><meta itemprop=image content=http://docs.kuzzle.io/assets/images/favicon/favicon-196x196.png><meta name=twitter:card value=summary><meta name=twitter:site content=@kuzzleio><meta name=twitter:title content=search><meta name=twitter:creator content=@kuzzleio><meta name=twitter:image content=http://docs.kuzzle.io/assets/images/favicon/favicon-196x196.png><meta property=og:title content=search><meta property=og:type content=article><meta property=og:site_name content=""><meta property=og:image content=http://docs.kuzzle.io/assets/images/favicon/favicon-96x96.png><meta property=article:published_time content=2017-08-30T15:07:32.787Z><meta property=article:modified_time content=2017-08-30T15:07:32.787Z><meta property=article:section content="SDK Reference"><meta property=article:tag content=Collection><link rel=apple-touch-icon-precomposed sizes=57x57 href=/assets/images/favicon/apple-touch-icon-57x57.png><link rel=apple-touch-icon-precomposed sizes=114x114 href=/assets/images/favicon/apple-touch-icon-114x114.png><link rel=apple-touch-icon-precomposed sizes=72x72 href=/assets/images/favicon/apple-touch-icon-72x72.png><link rel=apple-touch-icon-precomposed sizes=144x144 href=/assets/images/favicon/apple-touch-icon-144x144.png><link rel=apple-touch-icon-precomposed sizes=60x60 href=/assets/images/favicon/apple-touch-icon-60x60.png><link rel=apple-touch-icon-precomposed sizes=120x120 href=/assets/images/favicon/apple-touch-icon-120x120.png><link rel=apple-touch-icon-precomposed sizes=76x76 href=/assets/images/favicon/apple-touch-icon-76x76.png><link rel=apple-touch-icon-precomposed sizes=152x152 href=/assets/images/favicon/apple-touch-icon-152x152.png><link rel=icon type=image/png href=/assets/images/favicon/favicon-196x196.png sizes=196x196><link rel=icon type=image/png href=/assets/images/favicon/favicon-96x96.png sizes=96x96><link rel=icon type=image/png href=/assets/images/favicon/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/assets/images/favicon/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/assets/images/favicon/favicon-128.png sizes=128x128><link rel=stylesheet href=/assets/font-awesome/scss/font-awesome.css><link href="//fonts.googleapis.com/css?family=Ubuntu:400,500,700" rel=stylesheet><title>search - Collection - SDK Reference - Kuzzle documentation</title><link rel=stylesheet href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/atom-one-dark.min.css><link href=/assets/stylesheets/side-code/screen.css rel=stylesheet type=text/css media=screen></head><body class=index><header><div class=wrapper><div id=logo><a href=http://kuzzle.io/ >&#xA0;</a></div><a class=mobile-nav-burger href=javascript:;></a><nav><ul><li><a href=http://kuzzle.io/kuzzle-enterprise/ class=nav-item>product</a></li><li><a href=http://docs.kuzzle.io/ class="nav-item developers active">Documentation</a><ul class=mobile-nav><li><a href=/guide><span>Guide</span></a></li><li class=active><a href=/sdk-reference><span>SDK Reference</span></a><ul class=sub-nav><li><a href=/sdk-reference/essentials><span>Essentials</span></a></li><li><a href=/sdk-reference/kuzzle><span>Kuzzle</span></a></li><li class=active><a href=/sdk-reference/collection><span>Collection</span></a></li><li><a href=/sdk-reference/collection-mapping><span>CollectionMapping</span></a></li><li><a href=/sdk-reference/document><span>Document</span></a></li><li><a href=/sdk-reference/memory-storage><span>MemoryStorage</span></a></li><li><a href=/sdk-reference/profile><span>Profile</span></a></li><li><a href=/sdk-reference/role><span>Role</span></a></li><li><a href=/sdk-reference/room><span>Room</span></a></li><li><a href=/sdk-reference/search-result><span>SearchResult</span></a></li><li><a href=/sdk-reference/security><span>Security</span></a></li><li><a href=/sdk-reference/user><span>User</span></a></li></ul></li><li><a href=/kuzzle-dsl><span>Kuzzle DSL</span></a></li><li><a href=/validation-reference><span>Data Validation</span></a></li><li><a href=/api-documentation><span>API Documentation</span></a></li><li><a href=/plugins-reference><span>Plugins Reference</span></a></li><li><a href=/kuzzle-events><span>Kuzzle events</span></a></li><li><a href=/elasticsearch-cookbook><span>Elasticsearch Cookbook</span></a></li></ul></li><li><a href=http://kuzzle.io/demos-tutorials/ class=nav-item>Demos</a></li><li><a href=http://kuzzle.io/blog/ class=nav-item>Blog</a></li><li><a href=http://kuzzle.io/contact/ class=nav-item>Contact</a></li><li><a href=http://kuzzle.io/install-kuzzle/ class=nav-item>Try it</a></li><li><a href=https://github.com/kuzzleio/kuzzle target=_blank class="nav-item github"><i class="icon icon-github icon-small"></i></a></li></ul></nav></div><div class="developer-nav open"><ul class=search><li><input name=search type=search placeholder=search tabindex=1></li></ul><ul class=nav><li><a href=/guide><span>Guide</span></a></li><li class=active><a href=/sdk-reference><span>SDK Reference</span></a></li><li><a href=/kuzzle-dsl><span>Kuzzle DSL</span></a></li><li><a href=/validation-reference><span>Data Validation</span></a></li><li><a href=/api-documentation><span>API Documentation</span></a></li><li><a href=/plugins-reference><span>Plugins Reference</span></a></li><li><a href=/kuzzle-events><span>Kuzzle events</span></a></li><li><a href=/elasticsearch-cookbook><span>Elasticsearch Cookbook</span></a></li></ul><div class=search-results><ul></ul></div><script type=text/plain id=search-results-template><li>
        <a href="__link__" tabindex="__tabindex__">
          <p class="page">
            <span class="title">__title__</span>
            <span class="firstMember">__firstMember__</span>
            <span class="parent">__parent__</span>
          </p>
          <p class="preview">__preview__</p>
        </a>
      </li></script></div></header><div class=container><div class=tocify-wrapper><ul class=search-results></ul><div class=tocify><ul class=tocify-header><li class="tocify-item tocify-focus tocify-hover"></li></ul><ul class=tocify-header><li class=tocify-item><a style="color: #111; text-decoration: none" href=http://docs.kuzzle.io/sdk-reference title="back to SDK Reference home">SDK Reference</a></li><ul class=tocify-subheader><li class=tocify-item><a style="color: #002835; text-decoration: none" href=/sdk-reference/essentials/events title="Kuzzle SDKs basic concepts">Essentials</a></li><li class=tocify-item><a style="color: #002835; text-decoration: none" href=/sdk-reference/kuzzle title="Entry point and main class for the entire SDK">Kuzzle</a></li><li class="tocify-item tocify-focus"><a style="color: #FFF; text-decoration: none" href=# title="Data collection methods">Collection</a></li><ul class=tocify-header><ul class=tocify-subheader><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection title="Data collection methods">&#x203A; Constructor</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/collection-mapping title=collectionMapping>&#x203A; collectionMapping</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/count title=count>&#x203A; count</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/create title=create>&#x203A; create</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/create-document title=createDocument>&#x203A; createDocument</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/delete-document title=deleteDocument>&#x203A; deleteDocument</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/delete-specifications title=deleteSpecifications>&#x203A; deleteSpecifications</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/document title=document>&#x203A; document</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/fetch-document title=fetchDocument>&#x203A; fetchDocument</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/get-mapping title=getMapping>&#x203A; getMapping</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/get-specifications title=getSpecifications>&#x203A; getSpecifications</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/mcreate-document title=mCreateDocument>&#x203A; mCreateDocument</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/mcreate-or-replace-document title=mCreateOrReplaceDocument>&#x203A; mCreateOrReplaceDocument</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/mdelete-document title=mDeleteDocument>&#x203A; mDeleteDocument</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/mget-document title=mGetDocument>&#x203A; mGetDocument</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/mreplace-document title=mReplaceDocument>&#x203A; mReplaceDocument</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/mupdate-document title=mUpdateDocument>&#x203A; mUpdateDocument</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/publish-message title=publishMessage>&#x203A; publishMessage</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/replace-document title=replaceDocument>&#x203A; replaceDocument</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/room title=room>&#x203A; room</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/scroll title=scroll>&#x203A; scroll</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/scroll-specifications title=scrollSpecifications>&#x203A; scrollSpecifications</a></li><li class="tocify-item tocify-level-2 tocify-focus"><a style="color: #FFF; text-decoration: none" href=/sdk-reference/collection/search title=search>&#x203A; search</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/search-specifications title=searchSpecifications>&#x203A; searchSpecifications</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/set-headers title=setHeaders>&#x203A; setHeaders</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/subscribe title=subscribe>&#x203A; subscribe</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/truncate title=truncate>&#x203A; truncate</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/update-document title=updateDocument>&#x203A; updateDocument</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/update-specifications title=updateSpecifications>&#x203A; updateSpecifications</a></li><li class="tocify-item tocify-level-2"><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection/validate-specifications title=validateSpecifications>&#x203A; validateSpecifications</a></li></ul></ul><li class=tocify-item><a style="color: #002835; text-decoration: none" href=/sdk-reference/collection-mapping title="Methods manipulating data collection structures">CollectionMapping</a></li><li class=tocify-item><a style="color: #002835; text-decoration: none" href=/sdk-reference/document title="Class for documents handling">Document</a></li><li class=tocify-item><a style="color: #002835; text-decoration: none" href=/sdk-reference/memory-storage title="Memory cache storage methods">MemoryStorage</a></li><li class=tocify-item><a style="color: #002835; text-decoration: none" href=/sdk-reference/profile title="Permission profiles manipulation">Profile</a></li><li class=tocify-item><a style="color: #002835; text-decoration: none" href=/sdk-reference/role title="Permission roles manipulation">Role</a></li><li class=tocify-item><a style="color: #002835; text-decoration: none" href=/sdk-reference/room title="Real-time subscription management class">Room</a></li><li class=tocify-item><a style="color: #002835; text-decoration: none" href=/sdk-reference/search-result title="Search result navigation class">SearchResult</a></li><li class=tocify-item><a style="color: #002835; text-decoration: none" href=/sdk-reference/security title="Rights administration methods">Security</a></li><li class=tocify-item><a style="color: #002835; text-decoration: none" href=/sdk-reference/user title="Permission users manipulation">User</a></li></ul></ul><ul class=toc-footer></ul></div></div><div class=page-wrapper><div class=content><div class=mobile-breadcrumb><p style=float:left><a href=http://docs.kuzzle.io/ >Kuzzle documentation</a> &#xBB; <a href=http://docs.kuzzle.io/sdk-reference>SDK Reference</a> &#xBB; <a href=http://docs.kuzzle.io/sdk-reference/collection>Collection</a> &#xBB; search</p><p style=float:right class=version-selector><select onchange="window.location = this.value"><option selected>1.x</option></select></p></div><div class=nav-sibling><div class=nav-left><p><a href=https://github.com/kuzzleio/documentation/edit/master/src/sdk-reference/collection/search.md>edit on github<i class="icon icon-github icon-small"></i></a> <span class=separator>|</span> <a href="https://github.com/kuzzleio/documentation/issues/new?labels=sdk-reference&amp;title=Feedback%20about%20page%20&apos;sdk-reference/collection/search.md&apos;">send feedback about this content<i class="icon icon-github icon-small"></i></a> <span class=separator>|</span><select class=rate-documentation><option value=""></option><option value=1>Unusable documentation</option><option value=2>Poor documentation</option><option value=3>OK documentation</option><option value=4>Good documentation</option><option value=5>Excellent documentation</option></select></p></div><div class=nav-right><p class=version-selector><span>current version:</span><select onchange="window.location = this.value"><option selected>1.x</option></select></p></div><div style=clear:both></div></div><div class=main-content><h1><a class=anchor id=search></a>search</h1><div class=language-tab-selector><a href=# class=language-tab-active data-language-name=js>Javascript</a><a href=# data-language-name=java>Android</a><a href=# data-language-name=php>PHP</a></div><pre class="language-tab language-first-tab language-tab-active" data-language=js><code class="hljs js"><span class=hljs-keyword>const</span>
  body = {
    <span class=hljs-attr>query</span>: {
      <span class=hljs-attr>bool</span>: {
        <span class=hljs-attr>must</span>: [
          {
            <span class=hljs-attr>terms</span>: {<span class=hljs-attr>status</span>: [<span class=hljs-string>&apos;idle&apos;</span>, <span class=hljs-string>&apos;wantToHire&apos;</span>, <span class=hljs-string>&apos;toHire&apos;</span>, <span class=hljs-string>&apos;riding&apos;</span>]}
          },
          {
            <span class=hljs-attr>term</span>: {<span class=hljs-attr>type</span>: <span class=hljs-string>&apos;cab&apos;</span>}
          },
          {
            <span class=hljs-attr>geo_distance</span>: {
              <span class=hljs-attr>distance</span>: <span class=hljs-string>&apos;10km&apos;</span>,
              <span class=hljs-attr>pos</span>: {<span class=hljs-attr>lat</span>: <span class=hljs-string>&apos;48.8566140&apos;</span>, <span class=hljs-attr>lon</span>: <span class=hljs-string>&apos;2.352222&apos;</span>}
            }
          }
        ]
      }
    },
    <span class=hljs-attr>sort</span>: [
      <span class=hljs-string>&apos;status&apos;</span>,
      {
        <span class=hljs-attr>_geo_distance</span> : {
          <span class=hljs-attr>pos</span>: {<span class=hljs-attr>lat</span>: <span class=hljs-string>&apos;48.8566140&apos;</span>, <span class=hljs-attr>lon</span>: <span class=hljs-string>&apos;2.352222&apos;</span>},
          <span class=hljs-attr>order</span> : <span class=hljs-string>&quot;asc&quot;</span>
        }
      },
      {<span class=hljs-attr>date</span>: <span class=hljs-string>&quot;desc&quot;</span>}
    ],
    <span class=hljs-attr>aggregations</span>: {
      <span class=hljs-attr>aggs_name</span>: {
        <span class=hljs-attr>terms</span>: {
          <span class=hljs-attr>field</span>: <span class=hljs-string>&quot;field_name&quot;</span>
        }
      }
    }
  },
  options= {
    <span class=hljs-attr>from</span>: <span class=hljs-number>0</span>,
    <span class=hljs-attr>size</span>: <span class=hljs-number>20</span>
  };

<span class=hljs-comment>// Using callbacks (NodeJS or Web Browser)</span>
kuzzle
  .collection(<span class=hljs-string>&apos;collection&apos;</span>, <span class=hljs-string>&apos;index&apos;</span>)
  .search(body, options, <span class=hljs-function><span class=hljs-keyword>function</span> (<span class=hljs-params>err, searchResult</span>) </span>{
    searchResult.getDocuments().forEach(<span class=hljs-function><span class=hljs-keyword>function</span>(<span class=hljs-params>document</span>) </span>{
      <span class=hljs-built_in>console</span>.log(<span class=hljs-built_in>document</span>.toString());
    });
  });

<span class=hljs-comment>// Using promises (NodeJS only)</span>
kuzzle
  .collection(<span class=hljs-string>&apos;collection&apos;</span>, <span class=hljs-string>&apos;index&apos;</span>)
  .searchPromise(body, options)
  .then(<span class=hljs-function><span class=hljs-params>searchResult</span> =&gt;</span> {
    searchResult.getDocuments().forEach(<span class=hljs-function><span class=hljs-params>document</span> =&gt;</span> {
      <span class=hljs-built_in>console</span>.log(<span class=hljs-built_in>document</span>.toString());
    });
  });</code></pre><pre class=language-tab data-language=java><code class="hljs java"><span class=hljs-keyword>import</span> io.kuzzle.sdk.core.Kuzzle;
<span class=hljs-keyword>import</span> io.kuzzle.sdk.core.Options; 

Kuzzle kuzzle = <span class=hljs-keyword>new</span> Kuzzle(<span class=hljs-string>&quot;localhost&quot;</span>);

JSONObject body = <span class=hljs-keyword>new</span> JSONObject()
  .put(<span class=hljs-string>&quot;query&quot;</span>, <span class=hljs-keyword>new</span> JSONObject()
    .put(<span class=hljs-string>&quot;bool&quot;</span>, <span class=hljs-keyword>new</span> JSONObject()
      .put(<span class=hljs-string>&quot;must&quot;</span>, <span class=hljs-keyword>new</span> JSONArray()
        .put(
          <span class=hljs-keyword>new</span> JSONObject().put(<span class=hljs-string>&quot;terms&quot;</span>,
            <span class=hljs-keyword>new</span> JSONObject().put(<span class=hljs-string>&quot;status&quot;</span>,
              <span class=hljs-keyword>new</span> JSONArray()
                .put(<span class=hljs-string>&quot;idle&quot;</span>)
                .put(<span class=hljs-string>&quot;wantToHire&quot;</span>)
                .put(<span class=hljs-string>&quot;toHire&quot;</span>)
                .put(<span class=hljs-string>&quot;riding&quot;</span>)
            )
          )
        )
        .put(
          <span class=hljs-keyword>new</span> JSONObject().put(<span class=hljs-string>&quot;term&quot;</span>,
            <span class=hljs-keyword>new</span> JSONObject()
              .put(<span class=hljs-string>&quot;type&quot;</span>, <span class=hljs-keyword>new</span> JSONArray().put(<span class=hljs-string>&quot;cab&quot;</span>))
          )
        )
        .put(
          <span class=hljs-keyword>new</span> JSONObject().put(<span class=hljs-string>&quot;geo_distance&quot;</span>,
            <span class=hljs-keyword>new</span> JSONObject()
              .put(<span class=hljs-string>&quot;distance&quot;</span>, <span class=hljs-string>&quot;10km&quot;</span>)
              .put(<span class=hljs-string>&quot;pos&quot;</span>,
                <span class=hljs-keyword>new</span> JSONObject()
                  .put(<span class=hljs-string>&quot;lat&quot;</span>, <span class=hljs-string>&quot;48.8566140&quot;</span>)
                  .put(<span class=hljs-string>&quot;lon&quot;</span>, <span class=hljs-string>&quot;2.352222&quot;</span>)
              )
          )
        )
      )
    )
  )
  .put(<span class=hljs-string>&quot;sort&quot;</span>, <span class=hljs-keyword>new</span> JSONArray()
    .put(<span class=hljs-string>&quot;status&quot;</span>)
    .put(<span class=hljs-keyword>new</span> JSONObject()
      .put(<span class=hljs-string>&quot;_geo_distance&quot;</span>, <span class=hljs-keyword>new</span> JSONObject()
        .put(<span class=hljs-string>&quot;pos&quot;</span>, <span class=hljs-keyword>new</span> JSONObject()
          .put(<span class=hljs-string>&quot;lat&quot;</span>, <span class=hljs-string>&quot;48.8566140&quot;</span>)
          .put(<span class=hljs-string>&quot;lon&quot;</span>, <span class=hljs-string>&quot;2.352222&quot;</span>)
        )
        .put(<span class=hljs-string>&apos;order&apos;</span>; <span class=hljs-string>&quot;asc&quot;</span>)
      )
    )
    .put(<span class=hljs-keyword>new</span> JSONObject()
      .put(<span class=hljs-string>&quot;date&quot;</span>, <span class=hljs-string>&quot;desc&quot;</span>)
    )
  )
  .put(<span class=hljs-string>&quot;aggregations&quot;</span>, <span class=hljs-keyword>new</span> JSONObject()
    .put(<span class=hljs-string>&quot;aggs_name&quot;</span>, <span class=hljs-keyword>new</span> JSONObject()
      .put(<span class=hljs-string>&quot;terms&quot;</span>, <span class=hljs-keyword>new</span> JSONObject()
        .put(<span class=hljs-string>&quot;field&quot;</span>, <span class=hljs-string>&quot;field_name&quot;</span>)
      )
    )
  );

Options options = <span class=hljs-keyword>new</span> Options();
options.setFrom((<span class=hljs-keyword>long</span>) <span class=hljs-number>0</span>);
options.setSize((<span class=hljs-keyword>long</span>) <span class=hljs-number>20</span>);

kuzzle
  .collection(<span class=hljs-string>&quot;collection&quot;</span>, <span class=hljs-string>&quot;index&quot;</span>)
  .search(body, options, <span class=hljs-keyword>new</span> ResponseListener&lt;SearchResult&gt;() {
    <span class=hljs-meta>@Override</span>
    <span class=hljs-function><span class=hljs-keyword>public</span> <span class=hljs-keyword>void</span> <span class=hljs-title>onSuccess</span><span class=hljs-params>(SearchResult searchResult)</span> </span>{
      <span class=hljs-keyword>for</span> (Document doc : searchResult.getDocuments()) {
        <span class=hljs-comment>// Get documents</span>
      }

      searchResult.getTotal(); <span class=hljs-comment>// return total of documents returned</span>

      searchResult.getAggregations(): <span class=hljs-comment>// return a JSONObject representing the aggregations response</span>
    }

    <span class=hljs-meta>@Override</span>
    <span class=hljs-function><span class=hljs-keyword>public</span> <span class=hljs-keyword>void</span> <span class=hljs-title>onError</span><span class=hljs-params>(JSONObject error)</span> </span>{
      <span class=hljs-comment>// Handle error</span>
    }
  });</code></pre><pre class=language-tab data-language=php><code class="hljs php"><span class=hljs-meta>&lt;?php</span>

<span class=hljs-keyword>use</span> \<span class=hljs-title>Kuzzle</span>\<span class=hljs-title>Kuzzle</span>;
<span class=hljs-keyword>use</span> \<span class=hljs-title>Kuzzle</span>\<span class=hljs-title>Document</span>;
<span class=hljs-keyword>use</span> \<span class=hljs-title>Kuzzle</span>\<span class=hljs-title>Util</span>\<span class=hljs-title>SearchResult</span>;

$body = [
  <span class=hljs-string>&apos;query&apos;</span> =&gt; [
    <span class=hljs-string>&apos;bool&apos;</span> =&gt; [
      <span class=hljs-string>&apos;must&apos;</span> =&gt; [
        [
          <span class=hljs-string>&apos;terms&apos;</span> =&gt; [<span class=hljs-string>&apos;status&apos;</span> =&gt; [<span class=hljs-string>&apos;idle&apos;</span>, <span class=hljs-string>&apos;wantToHire&apos;</span>, <span class=hljs-string>&apos;toHire&apos;</span>, <span class=hljs-string>&apos;riding&apos;</span>]]
        ],
        [<span class=hljs-string>&apos;term&apos;</span> =&gt; <span class=hljs-string>&apos;cab&apos;</span>],
        [
          <span class=hljs-string>&apos;geo_distance&apos;</span> =&gt; [
            <span class=hljs-string>&apos;distance&apos;</span> =&gt; <span class=hljs-string>&apos;10km&apos;</span>,
            <span class=hljs-string>&apos;pos&apos;</span> =&gt; [
              <span class=hljs-string>&apos;lat&apos;</span> =&gt; <span class=hljs-string>&apos;48.8566140&apos;</span>,
              <span class=hljs-string>&apos;lon&apos;</span> =&gt; <span class=hljs-string>&apos;2.352222&apos;</span>
            ]
          ]
        ]
      ]
    ]
  ],
  <span class=hljs-string>&apos;sort&apos;</span> =&gt; [
    <span class=hljs-string>&apos;status&apos;</span>,
    [
      <span class=hljs-string>&apos;_geo_distance&apos;</span> =&gt; [
        <span class=hljs-string>&apos;pos&apos;</span> =&gt; [<span class=hljs-string>&apos;lat&apos;</span> =&gt; <span class=hljs-string>&apos;48.8566140&apos;</span>, <span class=hljs-string>&apos;lon&apos;</span> =&gt; <span class=hljs-string>&apos;2.352222&apos;</span>],
        <span class=hljs-string>&apos;order&apos;</span> =&gt; <span class=hljs-string>&apos;asc&apos;</span>
      ]
    ],
    [<span class=hljs-string>&apos;date&apos;</span> =&gt; <span class=hljs-string>&apos;desc&apos;</span>]
  ],
  <span class=hljs-string>&apos;aggregations&apos;</span> =&gt; [
    <span class=hljs-string>&apos;aggs_name&apos;</span> =&gt; [
      <span class=hljs-string>&apos;terms&apos;</span> =&gt; [
        <span class=hljs-string>&apos;field&apos;</span> =&gt; <span class=hljs-string>&apos;field_name&apos;</span>
      ]
    ]
  ]
];

$options = [
  <span class=hljs-string>&apos;from&apos;</span> =&gt; <span class=hljs-number>0</span>,
  <span class=hljs-string>&apos;size&apos;</span> =&gt; <span class=hljs-number>20</span>
];

$kuzzle = <span class=hljs-keyword>new</span> Kuzzle(<span class=hljs-string>&apos;localhost&apos;</span>);
$dataCollection = $kuzzle-&gt;collection(<span class=hljs-string>&apos;collection&apos;</span>, <span class=hljs-string>&apos;index&apos;</span>);

<span class=hljs-keyword>try</span> {
  $searchResult = $dataCollection-&gt;search($body, $options);

  <span class=hljs-comment>// $searchResult instanceof SearchResult</span>
  $searchResult-&gt;getTotal();

  <span class=hljs-keyword>foreach</span>($searchResult-&gt;getDocuments() <span class=hljs-keyword>as</span> $document) {
    <span class=hljs-comment>// $document instanceof Document</span>
  }

  <span class=hljs-comment>// return an array representing the aggregations response</span>
  $searchResult-&gt;getAggregations();
}
<span class=hljs-keyword>catch</span> (ErrorException $e) {

}</code></pre><p>Executes a search on the data collection.</p><aside class=notice>There is a small delay between documents creation and their existence in our search layer, usually a couple of seconds. That means that a document that was just been created won&apos;t be returned by this function</aside><h2><a class=anchor id=processing-large-data-sets></a>Processing large data sets</h2><p>When processing a large number of documents (i.e. more than 1000), using <code>search</code> requests only is not the best option.</p><p>Pagination of results can be done by using the from and size but the cost becomes prohibitive when the deep pagination is reached. In fact, Elasticsearch, the database Kuzzle is relying on, prevents going beyond 10,000 results by default.</p><p>Instead, the recommended way to process a large number of documents is to use <a href=/sdk-reference/collection/scroll/ ><code>Collection.scroll</code></a> or, easier, <a href=/sdk-reference/search-result/fetch-next><code>SearchResult.fetchNext</code></a>.</p><p>See <a href=/sdk-reference/search-result/fetch-next/#how-to-process-every-document-of-a-collection><code>SearchResult.fetchNext</code></a> for an example of how to process every document of a collection.</p><hr><h2><a class=anchor id=search-body-options-callback></a>search(body, [options], callback)</h2><table><thead><tr><th>Arguments</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>body</code></td><td>JSON object</td><td>Search request body, using <a href=https://www.elastic.co/guide/en/elasticsearch/reference/5.x/search-request-body.html>ElasticSearch Query DSL</a> format.<br>If given an empty object, matches all documents in the collection</td></tr><tr><td><code>options</code></td><td>JSON object</td><td>Optional parameters</td></tr><tr><td><code>callback</code></td><td>function</td><td>Callback handling the response</td></tr></tbody></table><hr><h2><a class=anchor id=options></a>Options</h2><table><thead><tr><th>Option</th><th>Type</th><th>Description</th><th>Default</th></tr></thead><tbody><tr><td><code>from</code></td><td>number</td><td>Provide the starting offset of the request (used to paginate results)</td><td><code>0</code></td></tr><tr><td><code>queuable</code></td><td>boolean</td><td>Mark this request as (not) queuable</td><td><code>true</code></td></tr><tr><td><code>scroll</code></td><td>string</td><td>Start a scroll session, with a time to live equals to this parameter&apos;s value following the <a href=https://www.elastic.co/guide/en/elasticsearch/reference/5.0/common-options.html#time-units>Elastisearch time format</a></td><td><code>undefined</code></td></tr><tr><td><code>size</code></td><td>number</td><td>Provide the maximum number of results of the request (used to paginate results)</td><td><code>10</code></td></tr></tbody></table><aside class=notice>To get more information about scroll sessions, please refer to the <a href=/api-documentation/controller-document/search>API reference documentation</a>.</aside><hr><h2><a class=anchor id=callback-response></a>Callback response</h2><p>Resolves to an instance of <a href=/sdk-reference/search-result>SearchResult</a>.</p><div style="clear: both"></div></div><hr><div id=disqus_thread></div><script async data-packer=exclude>var disqus_developer = 1;
        
          var disqus_config = function () {
            this.page.url = 'http://docs.kuzzle.io/sdk-reference/collection/search';
            this.page.title = 'search';
            this.page.identifier = 'sdk-reference/collection/search';
          };
        
          (function() {
            var d = document, s = d.createElement('script');
            s.src = 'https://kuzzle-documentation.disqus.com/embed.js';
            s.async = 'async';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
          })();</script><div class="nav-sibling bottom"><div class=nav-left><p><a href=https://github.com/kuzzleio/documentation/edit/master/src/sdk-reference/collection/search.md>edit on github<i class="icon icon-github icon-small"></i></a> <span class=separator>|</span> <a href="https://github.com/kuzzleio/documentation/issues/new?labels=sdk-reference&amp;title=Feedback%20about%20page%20&apos;sdk-reference/collection/search.md&apos;">send feedback about this content<i class="icon icon-github icon-small"></i></a> <span class=separator>|</span><select class=rate-documentation><option value=""></option><option value=1>Unusable documentation</option><option value=2>Poor documentation</option><option value=3>OK documentation</option><option value=4>Good documentation</option><option value=5>Excellent documentation</option></select></p></div><div class=nav-right><p class=medium-only></p><p><a href=#>back to top &#x2191;</a></p></div><div style=clear:both></div></div></div></div></div><script type=text/javascript data-packer=exclude>var path = 'sdk-reference/collection/search';
  var site_url = 'http://docs.kuzzle.io'
  var site_base_path = '/'
  var ancestry_parent_path = 'sdk-reference'
  var report404ga = ''
  var algolia_projectId = '4RFBRWISJR'
  var algolia_publicKey = '6febf1ebe906bd82bce58d5a20ac6c1b'</script><script src=/assets/javascript/e6791aa54bf763f10700a88b38d578282663be53.min.js></script></body></html>